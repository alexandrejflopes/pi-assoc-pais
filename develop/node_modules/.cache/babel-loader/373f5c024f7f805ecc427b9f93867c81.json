{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { firebaseConfig, firestore, storageRef } from \"../firebase-config\";\nimport React from \"react\";\nimport { languageCode, parentsParameters } from \"../utils/general_utils\";\n\nfunction addCasosExemplo() {\n  var casosRef = firestore.collection(\"casos\"); // parametros\n  // titulo , descricao , privado(true/false) , membros [ {'nome':'maria','id':'pljouHGIHpo'},{'nome':'jose','id':'SIdjisdnDI'} ]\n\n  var casosExemplo = [{\n    titulo: \"Água a entrar na sala 12\",\n    descricao: \"Desde terça-feira, que temos água a entrar na sala, o que coloca em questão o armazenamento de\" + \" instrumentos, uma vez que não há pouco espaço para os transferir para outro local.\",\n    privado: false,\n    membros: [],\n    nome_autor: \"Diogo Gomes\",\n    id_autor: \"dgomes@pi-assoc-pais.com\"\n  }, {\n    titulo: \"Material insuficiente na sala 7\",\n    descricao: \"Há carência de equipamento necessário para a realização das aulas Artes Visuais na sala 7\",\n    privado: false,\n    membros: [],\n    nome_autor: \"Mário Silva\",\n    id_autor: \"mario.silva@pi-assoc-pais.com\"\n  }, {\n    titulo: \"Rixa entre o Gonçalo e o João do 1º ano\",\n    descricao: \"Os dois alunos entraram numa rixa após, alegadamente, o João ter usado o afinador do Gonçalo\" + \"sem a sua autorização.\",\n    privado: true,\n    membros: [{\n      nome: \"Olivério Baptista\",\n      id: \"oliverio@pi-assoc-pais.com\"\n    }, {\n      nome: \"Luísa Santos\",\n      id: \"luisa.santos@pi-assoc-pais.com\"\n    }],\n    nome_autor: \"Vera Teixeira\",\n    // autor é adicionado automaticamente ao caso\n    id_autor: \"vera@pi-assoc-pais.com\"\n  }];\n\n  var _loop = function _loop(i) {\n    //alert(\"caso atual -> \" + JSON.stringify(casosExemplo[i]));\n    //console.log(\"caso atual -> \", casosExemplo[i]);\n    var titulo = encodeURIComponent(casosExemplo[i].titulo);\n    var descricao = encodeURIComponent(casosExemplo[i].descricao);\n    var membros = encodeURIComponent(JSON.stringify(casosExemplo[i].membros));\n    var privado = casosExemplo[i].privado;\n    var nome_autor = casosExemplo[i].nome_autor;\n    var id_autor = casosExemplo[i].id_autor;\n    var project_id = firebaseConfig.projectId;\n    var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/addCaso?\" + \"titulo=\" + titulo + \"&\" + \"descricao=\" + descricao + \"&\" + \"membros=\" + membros + \"&\" + \"privado=\" + privado + \"&\" + \"nome_autor=\" + nome_autor + \"&\" + \"id_autor=\" + id_autor;\n\n    var request = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(uri).then(function (data) {//alert(\"Caso adicionado com sucesso.\");\n                }).catch(function (error) {\n                  console.log(error);\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function request() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    request();\n  };\n\n  for (var i = 0; i < casosExemplo.length; i++) {\n    _loop(i);\n  }\n}\n\nfunction initCasosExemplo() {\n  firestore.collection(\"casos\").get().then(function (snapshot) {\n    if (snapshot.empty) {\n      console.log(\"Não há casos. Adicionado exemplos...\");\n      addCasosExemplo();\n    } else console.log(\"Já existem casos exemplo.\");\n  }).catch(function (err) {\n    console.log(\"Error getting collection \", err);\n  });\n}\n\nfunction showAvailableCasos() {\n  return _showAvailableCasos.apply(this, arguments);\n}\n\nfunction _showAvailableCasos() {\n  _showAvailableCasos = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n    var currentUser, nome, id, foto, project_id, uri, request;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            currentUser = JSON.parse(window.localStorage.getItem(\"userDoc\")); // utilizador teste\n\n            nome = \"\";\n            id = \"\";\n            foto = \"\";\n\n            if (currentUser != null) {\n              nome = currentUser[parentsParameters.NAME[languageCode]];\n              id = currentUser[parentsParameters.EMAIL[languageCode]];\n              foto = currentUser[parentsParameters.PHOTO[languageCode]];\n            }\n\n            project_id = firebaseConfig.projectId;\n            uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/getUserAvailableCasos?\" + \"id=\" + id;\n\n            request = /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                var casos;\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        _context3.next = 2;\n                        return fetch(uri).then(function (resp) {\n                          return resp.json();\n                        }) // Transform the data into json\n                        .then(function (data) {\n                          casos = data;\n                        }).catch(function (error) {\n                          console.log(error.toString());\n                        });\n\n                      case 2:\n                        return _context3.abrupt(\"return\", casos);\n\n                      case 3:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3);\n              }));\n\n              return function request() {\n                return _ref3.apply(this, arguments);\n              };\n            }();\n\n            return _context4.abrupt(\"return\", request());\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _showAvailableCasos.apply(this, arguments);\n}\n\nfunction addNewCaso() {\n  return _addNewCaso.apply(this, arguments);\n}\n/*\r\n* function to delete an issue/case\r\n* */\n\n\nfunction _addNewCaso() {\n  _addNewCaso = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n    var userAtual, userAtualId, titulo, descricao, membros, privado, uri, request;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            // utilizador teste TODO: obtê-lo do Firebase\n            userAtual = \"Diogo Gomes\";\n            userAtualId = \"hdf4684TKF\";\n            titulo = \"\";\n            descricao = \"\";\n            membros = \"\";\n            privado = false;\n            uri = \"https://us-central1-mytestproject-ffacc.cloudfunctions.net/addCaso?\" + \"titulo=\" + titulo + \"&\" + \"descricao=\" + descricao + \"&\" + \"membros=\" + membros + \"&\" + \"privado=\" + privado + \"&\" + \"nome_autor=\" + userAtual + \"&\" + \"id_autor=\" + userAtualId;\n\n            request = /*#__PURE__*/function () {\n              var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                var casos;\n                return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) {\n                    switch (_context5.prev = _context5.next) {\n                      case 0:\n                        _context5.next = 2;\n                        return fetch(uri).then(function (resp) {\n                          return resp.json();\n                        }) // Transform the data into json\n                        .then(function (data) {\n                          console.log(\"Showcasosdata -> \", data);\n                          console.log(\"primeiro caso titulo -> \", data[0].titulo);\n                          casos = data;\n                        }).catch(function (error) {\n                          console.log(error);\n                        });\n\n                      case 2:\n                        return _context5.abrupt(\"return\", casos);\n\n                      case 3:\n                      case \"end\":\n                        return _context5.stop();\n                    }\n                  }\n                }, _callee5);\n              }));\n\n              return function request() {\n                return _ref4.apply(this, arguments);\n              };\n            }();\n\n            return _context6.abrupt(\"return\", request());\n\n          case 9:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n  return _addNewCaso.apply(this, arguments);\n}\n\nfunction eraseCaso(id) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/deleteCaso?\" + \"id=\" + id;\n\n  var request = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              response = {};\n              _context2.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into blob / file\n              .then(function (resp) {\n                response = resp;\n                console.log(\"Case removed successfully\");\n              }).catch(function (error) {\n                response = null;\n                console.log(\"Delete case error: \" + error);\n              });\n\n            case 3:\n              return _context2.abrupt(\"return\", response);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function request() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return request();\n} // ---------------- NOVAS VERSOES --------------\n\n\nexport { initCasosExemplo, showAvailableCasos, eraseCaso };","map":{"version":3,"sources":["C:/Users/User/Desktop/Ambiente de Trabalho/Universidade/Ano 3/Semestre 2/PI/Projeto/repos/pi-assoc-pais/develop/src/firebase_scripts/casos.js"],"names":["firebaseConfig","firestore","storageRef","React","languageCode","parentsParameters","addCasosExemplo","casosRef","collection","casosExemplo","titulo","descricao","privado","membros","nome_autor","id_autor","nome","id","i","encodeURIComponent","JSON","stringify","project_id","projectId","uri","request","fetch","then","data","catch","error","console","log","length","initCasosExemplo","get","snapshot","empty","err","showAvailableCasos","currentUser","parse","window","localStorage","getItem","foto","NAME","EMAIL","PHOTO","resp","json","casos","toString","addNewCaso","userAtual","userAtualId","eraseCaso","response"],"mappings":"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","sourcesContent":["import { firebaseConfig, firestore, storageRef } from \"../firebase-config\";\r\nimport React from \"react\";\r\nimport { languageCode, parentsParameters } from \"../utils/general_utils\";\r\n\r\nfunction addCasosExemplo() {\r\n  let casosRef = firestore.collection(\"casos\");\r\n\r\n  // parametros\r\n  // titulo , descricao , privado(true/false) , membros [ {'nome':'maria','id':'pljouHGIHpo'},{'nome':'jose','id':'SIdjisdnDI'} ]\r\n\r\n  const casosExemplo = [\r\n    {\r\n      titulo: \"Água a entrar na sala 12\",\r\n      descricao:\r\n        \"Desde terça-feira, que temos água a entrar na sala, o que coloca em questão o armazenamento de\" +\r\n        \" instrumentos, uma vez que não há pouco espaço para os transferir para outro local.\",\r\n      privado: false,\r\n      membros: [],\r\n      nome_autor: \"Diogo Gomes\",\r\n      id_autor: \"dgomes@pi-assoc-pais.com\",\r\n    },\r\n    {\r\n      titulo: \"Material insuficiente na sala 7\",\r\n      descricao:\r\n        \"Há carência de equipamento necessário para a realização das aulas Artes Visuais na sala 7\",\r\n      privado: false,\r\n      membros: [],\r\n      nome_autor: \"Mário Silva\",\r\n      id_autor: \"mario.silva@pi-assoc-pais.com\",\r\n    },\r\n    {\r\n      titulo: \"Rixa entre o Gonçalo e o João do 1º ano\",\r\n      descricao:\r\n        \"Os dois alunos entraram numa rixa após, alegadamente, o João ter usado o afinador do Gonçalo\" +\r\n        \"sem a sua autorização.\",\r\n      privado: true,\r\n      membros: [\r\n        { nome: \"Olivério Baptista\", id: \"oliverio@pi-assoc-pais.com\" },\r\n        { nome: \"Luísa Santos\", id: \"luisa.santos@pi-assoc-pais.com\" },\r\n      ],\r\n      nome_autor: \"Vera Teixeira\", // autor é adicionado automaticamente ao caso\r\n      id_autor: \"vera@pi-assoc-pais.com\",\r\n    },\r\n  ];\r\n\r\n  for (let i = 0; i < casosExemplo.length; i++) {\r\n    //alert(\"caso atual -> \" + JSON.stringify(casosExemplo[i]));\r\n    //console.log(\"caso atual -> \", casosExemplo[i]);\r\n\r\n    const titulo = encodeURIComponent(casosExemplo[i].titulo);\r\n    const descricao = encodeURIComponent(casosExemplo[i].descricao);\r\n    const membros = encodeURIComponent(JSON.stringify(casosExemplo[i].membros));\r\n    const privado = casosExemplo[i].privado;\r\n    const nome_autor = casosExemplo[i].nome_autor;\r\n    const id_autor = casosExemplo[i].id_autor;\r\n\r\n    const project_id = firebaseConfig.projectId;\r\n\r\n    let uri =\r\n      \"https://us-central1-\" +\r\n      project_id +\r\n      \".cloudfunctions.net/api/addCaso?\" +\r\n      \"titulo=\" +\r\n      titulo +\r\n      \"&\" +\r\n      \"descricao=\" +\r\n      descricao +\r\n      \"&\" +\r\n      \"membros=\" +\r\n      membros +\r\n      \"&\" +\r\n      \"privado=\" +\r\n      privado +\r\n      \"&\" +\r\n      \"nome_autor=\" +\r\n      nome_autor +\r\n      \"&\" +\r\n      \"id_autor=\" +\r\n      id_autor;\r\n\r\n    const request = async () => {\r\n      await fetch(uri)\r\n        .then(function (data) {\r\n          //alert(\"Caso adicionado com sucesso.\");\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    };\r\n\r\n    request();\r\n  }\r\n}\r\n\r\nfunction initCasosExemplo() {\r\n  firestore\r\n    .collection(\"casos\")\r\n    .get()\r\n    .then((snapshot) => {\r\n      if (snapshot.empty) {\r\n        console.log(\"Não há casos. Adicionado exemplos...\");\r\n        addCasosExemplo();\r\n      } else console.log(\"Já existem casos exemplo.\");\r\n    })\r\n    .catch((err) => {\r\n      console.log(\"Error getting collection \", err);\r\n    });\r\n}\r\n\r\nasync function showAvailableCasos() {\r\n  var currentUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n  // utilizador teste\r\n\r\n  var nome = \"\";\r\n  var id = \"\";\r\n  var foto = \"\";\r\n  if (currentUser != null) {\r\n    nome = currentUser[parentsParameters.NAME[languageCode]];\r\n    id = currentUser[parentsParameters.EMAIL[languageCode]];\r\n    foto = currentUser[parentsParameters.PHOTO[languageCode]];\r\n  }\r\n\r\n  const project_id = firebaseConfig.projectId;\r\n\r\n  let uri =\r\n    \"https://us-central1-\" +\r\n    project_id +\r\n    \".cloudfunctions.net/api/getUserAvailableCasos?\" +\r\n    \"id=\" +\r\n    id;\r\n\r\n  const request = async () => {\r\n    let casos;\r\n    await fetch(uri)\r\n      .then((resp) => resp.json()) // Transform the data into json\r\n      .then(function (data) {\r\n        casos = data;\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error.toString());\r\n      });\r\n\r\n    return casos;\r\n  };\r\n\r\n  return request();\r\n}\r\n\r\nasync function addNewCaso() {\r\n  // utilizador teste TODO: obtê-lo do Firebase\r\n  const userAtual = \"Diogo Gomes\";\r\n  const userAtualId = \"hdf4684TKF\";\r\n\r\n  let titulo = \"\";\r\n  let descricao = \"\";\r\n  let membros = \"\";\r\n  let privado = false;\r\n\r\n  let uri =\r\n    \"https://us-central1-mytestproject-ffacc.cloudfunctions.net/addCaso?\" +\r\n    \"titulo=\" +\r\n    titulo +\r\n    \"&\" +\r\n    \"descricao=\" +\r\n    descricao +\r\n    \"&\" +\r\n    \"membros=\" +\r\n    membros +\r\n    \"&\" +\r\n    \"privado=\" +\r\n    privado +\r\n    \"&\" +\r\n    \"nome_autor=\" +\r\n    userAtual +\r\n    \"&\" +\r\n    \"id_autor=\" +\r\n    userAtualId;\r\n\r\n  const request = async () => {\r\n    let casos;\r\n    await fetch(uri)\r\n      .then((resp) => resp.json()) // Transform the data into json\r\n      .then(function (data) {\r\n        console.log(\"Showcasosdata -> \", data);\r\n        console.log(\"primeiro caso titulo -> \", data[0].titulo);\r\n        casos = data;\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n\r\n    return casos;\r\n  };\r\n\r\n  return request();\r\n}\r\n\r\n\r\n/*\r\n* function to delete an issue/case\r\n* */\r\nfunction eraseCaso(id) {\r\n  const project_id = firebaseConfig.projectId;\r\n  let uri =\r\n    \"https://us-central1-\" +\r\n    project_id +\r\n    \".cloudfunctions.net/api/deleteCaso?\" +\r\n    \"id=\" + id;\r\n\r\n  const request = async () => {\r\n    let response = {};\r\n    await fetch(uri)\r\n      .then((resp) => resp.json()) // Transform the data into blob / file\r\n      .then(function (resp) {\r\n        response = resp;\r\n        console.log(\"Case removed successfully\");\r\n      })\r\n      .catch(function (error) {\r\n        response = null;\r\n        console.log(\"Delete case error: \" + error);\r\n      });\r\n\r\n    return response;\r\n  };\r\n\r\n  return request();\r\n}\r\n\r\n// ---------------- NOVAS VERSOES --------------\r\n\r\nexport { initCasosExemplo, showAvailableCasos, eraseCaso};\r\n"]},"metadata":{},"sourceType":"module"}