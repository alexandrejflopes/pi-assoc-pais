{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\src\\\\components\\\\layout\\\\MainNavbar\\\\NavbarNav\\\\UserActions.js\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem, Collapse, NavItem, NavLink, Row } from \"shards-react\";\nimport { defaultAvatar, languageCode, parentsParameters } from \"../../../../utils/general_utils\";\nimport { profileLogout, profilePageTitle, profileSettings, profileSettingsAdminSectionTitle } from \"../../../../utils/page_titles_strings\";\nimport { fetchUserDoc, userLogOut } from \"../../../../firebase_scripts/profile_functions\";\nimport { firebase_auth } from \"../../../../firebase-config\";\n\nvar UserActions = /*#__PURE__*/function (_React$Component) {\n  _inherits(UserActions, _React$Component);\n\n  var _super = _createSuper(UserActions);\n\n  function UserActions(props) {\n    var _this;\n\n    _classCallCheck(this, UserActions);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      visible: false,\n      userName: \"ND\",\n      userPhoto: defaultAvatar,\n      isAdmin: false\n    };\n    _this.toggleUserActions = _this.toggleUserActions.bind(_assertThisInitialized(_this));\n    _this.updateNavBarUserPhotoAndName = _this.updateNavBarUserPhotoAndName.bind(_assertThisInitialized(_this)); //this.updateNavBarUserPhotoAndNameV2 = this.updateNavBarUserPhotoAndNameV2.bind(this);\n\n    return _this;\n  }\n  /*********************************** LIFECYCLE ***********************************/\n\n\n  _createClass(UserActions, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n      this.updateNavBarUserPhotoAndName(); //this.updateNavBarUserPhotoAndNameV2();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: \"toggleUserActions\",\n    value: function toggleUserActions() {\n      this.setState({\n        visible: !this.state.visible\n      });\n    }\n  }, {\n    key: \"updateNavBarUserPhotoAndNameV2\",\n    value: function updateNavBarUserPhotoAndNameV2() {\n      var currentUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n      console.log(\"local User barra: \" + currentUser);\n\n      if (currentUser != null) {\n        var displayName = currentUser[parentsParameters.NAME[languageCode]];\n        var photoURL = currentUser[parentsParameters.PHOTO[languageCode]];\n        var isAdmin = currentUser[parentsParameters.ADMIN[languageCode]];\n        this.setState({\n          userName: displayName,\n          userPhoto: photoURL,\n          isAdmin: isAdmin\n        });\n      }\n    }\n  }, {\n    key: \"updateNavBarUserPhotoAndName\",\n    value: function updateNavBarUserPhotoAndName() {\n      var _this2 = this;\n\n      // check the local storage to see if it's still the same user\n      var localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n      var firebaseUser = firebase_auth.currentUser;\n      console.log(\"localUser barra: \" + JSON.stringify(localUser));\n      console.log(\"currentUser: barra\" + JSON.stringify(firebaseUser));\n\n      if (localUser != null && firebaseUser != null) {\n        var localEmail = localUser[parentsParameters.EMAIL[languageCode]]; // if the local storage user is old, update the nav bar with the new user (fetching it from firestore)\n\n        if (localEmail !== firebaseUser.email) {\n          //console.log(\"fetch na barra\");\n          fetchUserDoc(firebaseUser.email).then(function (result) {\n            //console.log(\"Result userDoc: \" + JSON.stringify(result));\n            if (result.error == null) {\n              // no error\n              var displayName = result[parentsParameters.NAME[languageCode]];\n              var photoURL = result[parentsParameters.PHOTO[languageCode]];\n              var isAdmin = result[parentsParameters.ADMIN[languageCode]];\n\n              _this2.setState({\n                userName: displayName,\n                userPhoto: photoURL,\n                isAdmin: isAdmin\n              });\n            }\n          }).catch(function (error) {\n            console.log(\"error no fetch da barra: \" + JSON.stringify(error));\n          });\n        } else {\n          //console.log(\"aproveitar o storage\");\n          var displayName = localUser[parentsParameters.NAME[languageCode]];\n          var photoURL = localUser[parentsParameters.PHOTO[languageCode]];\n          var isAdmin = localUser[parentsParameters.ADMIN[languageCode]];\n          this.setState({\n            userName: displayName,\n            userPhoto: photoURL,\n            isAdmin: isAdmin\n          });\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(NavItem, {\n        tag: Dropdown,\n        caret: true,\n        toggle: this.toggleUserActions,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(DropdownToggle, {\n        caret: true,\n        tag: NavLink,\n        className: \"text-nowrap px-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"user-avatar rounded-circle mr-2\",\n        src: this.state.userPhoto,\n        alt: \"User photo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }\n      }), \" \", /*#__PURE__*/React.createElement(\"span\", {\n        className: \"d-none d-md-inline-block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }\n      }, this.state.userName)), /*#__PURE__*/React.createElement(Collapse, {\n        tag: DropdownMenu,\n        right: true,\n        small: true,\n        open: this.state.visible,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(DropdownItem, {\n        tag: Link,\n        to: \"profile\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"material-icons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }\n      }, \"\\uE7FD\"), \" \", profilePageTitle[languageCode]), /*#__PURE__*/React.createElement(DropdownItem, {\n        tag: Link,\n        to: \"profile-settings\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"material-icons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }\n      }, \"\\uE8B8\"), \" \", profileSettings[languageCode], \" \"), this.state.isAdmin ? /*#__PURE__*/React.createElement(DropdownItem, {\n        tag: Link,\n        to: \"admin-settings\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"material-icons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 15\n        }\n      }, \"vpn_key\"), \" \", profileSettingsAdminSectionTitle[languageCode], \" \") : null, /*#__PURE__*/React.createElement(DropdownItem, {\n        divider: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(DropdownItem, {\n        tag: Link,\n        onClick: userLogOut,\n        className: \"text-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"material-icons text-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }\n      }, \"\\uE879\"), \" \", profileLogout[languageCode])));\n    }\n  }]);\n\n  return UserActions;\n}(React.Component);\n\nexport { UserActions as default };","map":{"version":3,"sources":["C:/Users/User/Desktop/Ambiente de Trabalho/Universidade/Ano 3/Semestre 2/PI/Projeto/repos/pi-assoc-pais/develop/src/components/layout/MainNavbar/NavbarNav/UserActions.js"],"names":["React","Link","Dropdown","DropdownToggle","DropdownMenu","DropdownItem","Collapse","NavItem","NavLink","Row","defaultAvatar","languageCode","parentsParameters","profileLogout","profilePageTitle","profileSettings","profileSettingsAdminSectionTitle","fetchUserDoc","userLogOut","firebase_auth","UserActions","props","state","visible","userName","userPhoto","isAdmin","toggleUserActions","bind","updateNavBarUserPhotoAndName","_isMounted","setState","currentUser","JSON","parse","window","localStorage","getItem","console","log","displayName","NAME","photoURL","PHOTO","ADMIN","localUser","firebaseUser","stringify","localEmail","EMAIL","email","then","result","error","catch","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  Dropdown,\r\n  DropdownToggle,\r\n  DropdownMenu,\r\n  DropdownItem,\r\n  Collapse,\r\n  NavItem,\r\n  NavLink,\r\n  Row,\r\n} from \"shards-react\";\r\nimport {\r\n  defaultAvatar,\r\n  languageCode,\r\n  parentsParameters,\r\n} from \"../../../../utils/general_utils\";\r\nimport {\r\n  profileLogout,\r\n  profilePageTitle,\r\n  profileSettings, profileSettingsAdminSectionTitle,\r\n} from \"../../../../utils/page_titles_strings\";\r\nimport {\r\n  fetchUserDoc,\r\n  userLogOut,\r\n} from \"../../../../firebase_scripts/profile_functions\";\r\nimport { firebase_auth } from \"../../../../firebase-config\";\r\n\r\nexport default class UserActions extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      visible: false,\r\n      userName: \"ND\",\r\n      userPhoto: defaultAvatar,\r\n      isAdmin : false\r\n    };\r\n\r\n    this.toggleUserActions = this.toggleUserActions.bind(this);\r\n    this.updateNavBarUserPhotoAndName = this.updateNavBarUserPhotoAndName.bind(\r\n      this\r\n    );\r\n    //this.updateNavBarUserPhotoAndNameV2 = this.updateNavBarUserPhotoAndNameV2.bind(this);\r\n  }\r\n\r\n  /*********************************** LIFECYCLE ***********************************/\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n\r\n    this.updateNavBarUserPhotoAndName();\r\n    //this.updateNavBarUserPhotoAndNameV2();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  toggleUserActions() {\r\n    this.setState({\r\n      visible: !this.state.visible,\r\n    });\r\n  }\r\n\r\n  updateNavBarUserPhotoAndNameV2() {\r\n    let currentUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n    console.log(\"local User barra: \" + currentUser);\r\n    if (currentUser != null) {\r\n      const displayName = currentUser[parentsParameters.NAME[languageCode]];\r\n      const photoURL = currentUser[parentsParameters.PHOTO[languageCode]];\r\n      const isAdmin = currentUser[parentsParameters.ADMIN[languageCode]];\r\n\r\n      this.setState({ userName: displayName, userPhoto: photoURL, isAdmin : isAdmin });\r\n    }\r\n  }\r\n\r\n  updateNavBarUserPhotoAndName() {\r\n    // check the local storage to see if it's still the same user\r\n    let localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n    let firebaseUser = firebase_auth.currentUser;\r\n\r\n    console.log(\"localUser barra: \" + JSON.stringify(localUser));\r\n    console.log(\"currentUser: barra\" + JSON.stringify(firebaseUser));\r\n\r\n    if (localUser != null && firebaseUser != null) {\r\n      const localEmail = localUser[parentsParameters.EMAIL[languageCode]];\r\n      // if the local storage user is old, update the nav bar with the new user (fetching it from firestore)\r\n      if (localEmail !== firebaseUser.email) {\r\n        //console.log(\"fetch na barra\");\r\n        fetchUserDoc(firebaseUser.email)\r\n          .then((result) => {\r\n            //console.log(\"Result userDoc: \" + JSON.stringify(result));\r\n            if (result.error == null) {\r\n              // no error\r\n              const displayName = result[parentsParameters.NAME[languageCode]];\r\n              const photoURL = result[parentsParameters.PHOTO[languageCode]];\r\n              const isAdmin = result[parentsParameters.ADMIN[languageCode]];\r\n              this.setState({ userName: displayName, userPhoto: photoURL, isAdmin : isAdmin });\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"error no fetch da barra: \" + JSON.stringify(error));\r\n          });\r\n      } else {\r\n        //console.log(\"aproveitar o storage\");\r\n        const displayName = localUser[parentsParameters.NAME[languageCode]];\r\n        const photoURL = localUser[parentsParameters.PHOTO[languageCode]];\r\n        const isAdmin = localUser[parentsParameters.ADMIN[languageCode]];\r\n        this.setState({ userName: displayName, userPhoto: photoURL, isAdmin : isAdmin });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <NavItem tag={Dropdown} caret toggle={this.toggleUserActions}>\r\n        <DropdownToggle caret tag={NavLink} className=\"text-nowrap px-3\">\r\n          <img\r\n            className=\"user-avatar rounded-circle mr-2\"\r\n            src={this.state.userPhoto}\r\n            alt=\"User photo\"\r\n          />{\" \"}\r\n          <span className=\"d-none d-md-inline-block\">\r\n            {this.state.userName}\r\n          </span>\r\n        </DropdownToggle>\r\n        <Collapse tag={DropdownMenu} right small open={this.state.visible}>\r\n          <DropdownItem tag={Link} to=\"profile\">\r\n            <i className=\"material-icons\">&#xE7FD;</i>{\" \"}\r\n            {profilePageTitle[languageCode]}\r\n          </DropdownItem>\r\n          <DropdownItem tag={Link} to=\"profile-settings\">\r\n            <i className=\"material-icons\">&#xE8B8;</i>{\" \"}\r\n            {profileSettings[languageCode]}{\" \"}\r\n            {/*TODO: to export its data and delete account*/}\r\n          </DropdownItem>\r\n          {/* render admin option only if the user is admin */}\r\n          {this.state.isAdmin ?\r\n            <DropdownItem tag={Link} to=\"admin-settings\">\r\n              <i className=\"material-icons\">vpn_key</i>{\" \"}\r\n              {profileSettingsAdminSectionTitle[languageCode]}{\" \"}\r\n              {/* TODO: export assotiation data */}\r\n            </DropdownItem>\r\n          :\r\n          null}\r\n          <DropdownItem divider />\r\n          <DropdownItem tag={Link} onClick={userLogOut} className=\"text-danger\">\r\n            <i className=\"material-icons text-danger\">&#xE879;</i>{\" \"}\r\n            {profileLogout[languageCode]}\r\n          </DropdownItem>\r\n        </Collapse>\r\n      </NavItem>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}