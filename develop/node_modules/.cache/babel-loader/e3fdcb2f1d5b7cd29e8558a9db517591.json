{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\src\\\\views\\\\AdminSettings.js\";\nimport React from \"react\";\nimport { Container, Row, Col, Button, DropdownItem } from \"shards-react\";\nimport PageTitle from \"../components/common/PageTitle\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { firebase_auth } from \"../firebase-config\";\nimport { languageCode, parentsParameters } from \"../utils/general_utils\";\nimport { profileSettingsAdminSectionTitle, profileSettingsPageTitle } from \"../utils/page_titles_strings\";\nimport { loadingInfo } from \"../utils/messages_strings\";\nimport ExportAssocData from \"../components/profile/ExportAssocData\";\nimport { getAssocDoc } from \"../firebase_scripts/get_assoc_info\";\nimport AssocDataInfo from \"../components/profile/AssocDataInfo\";\n\nvar AdminSettings = /*#__PURE__*/function (_React$Component) {\n  _inherits(AdminSettings, _React$Component);\n\n  var _super = _createSuper(AdminSettings);\n\n  function AdminSettings(props) {\n    var _this;\n\n    _classCallCheck(this, AdminSettings);\n\n    _this = _super.call(this, props);\n    var localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n    var userEmail = null;\n    var userDoc = null;\n\n    if (localUser != null) {\n      userEmail = localUser[parentsParameters.EMAIL[languageCode]];\n      userDoc = localUser;\n    }\n\n    _this.state = {\n      userEmail: userEmail,\n      userDoc: userDoc,\n      assocDoc: null\n    }; //this.componentDidMount = this.componentDidMount.bind(this);\n\n    return _this;\n  }\n  /*********************************** LIFECYCLE ***********************************/\n\n\n  _createClass(AdminSettings, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n      var localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n\n      if (localUser != null) {\n        this.setState({\n          userDoc: localUser\n        });\n      }\n\n      console.log(\"atualizei-me!\");\n      /*if(updating){\r\n        const localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n        if(localUser!=null){\r\n          this.setState({userDoc : localUser});\r\n        }\r\n        const localAssocDoc = JSON.parse(window.localStorage.getItem(\"assocDoc\"));\r\n        if(localAssocDoc!=null){\r\n          this.setState({assocDoc: localAssocDoc});\r\n        }\r\n      }\r\n        else{\r\n        const localAssocDoc = JSON.parse(window.localStorage.getItem(\"assocDoc\"));\r\n        if(localAssocDoc!=null){\r\n          this.setState({assocDoc: localAssocDoc});\r\n        }\r\n        else{\r\n          const promise = getAssocDoc();\r\n          promise\r\n            .then(doc => {\r\n              if (!doc.exists) {\r\n                console.log('No assotiation document found!');\r\n              }\r\n              else {\r\n                const data = doc.data();\r\n                window.localStorage.setItem(\"assocDoc\", JSON.stringify(data));\r\n                this.setState({\r\n                  assocDoc: localAssocDoc\r\n                });\r\n              }\r\n            })\r\n            .catch(err => {\r\n              console.log('Error getting document', err);\r\n            });\r\n        }\r\n      }*/\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n    /*********************************** HANDLERS ***********************************/\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.userEmail == null || firebase_auth.currentUser == null) {\n        return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/login\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 14\n          }\n        });\n      } else if (this.state.userDoc == null || Object.keys(this.state.userDoc).length === 0\n      /*|| this.state.assocDoc == null*/\n      ) {\n          return /*#__PURE__*/React.createElement(Container, {\n            fluid: true,\n            className: \"main-content-container px-4\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 9\n            }\n          }, /*#__PURE__*/React.createElement(Row, {\n            fluid: true,\n            style: {\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignContent: \"center\",\n              alignItems: \"center\",\n              position: \"absolute\",\n              left: \"50%\",\n              top: \"50%\",\n              transform: \"translate(-50%, -50%)\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(\"h2\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 13\n            }\n          }, loadingInfo[languageCode])));\n        } else {\n        // if not admin, cannot see the page\n        if (!this.state.userDoc[parentsParameters.ADMIN[languageCode]]) {\n          return /*#__PURE__*/React.createElement(Redirect, {\n            to: \"/profile\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 16\n            }\n          });\n        } else {\n          return /*#__PURE__*/React.createElement(Container, {\n            fluid: true,\n            className: \"main-content-container px-4\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(Row, {\n            noGutters: true,\n            className: \"page-header py-4\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 13\n            }\n          }, /*#__PURE__*/React.createElement(PageTitle, {\n            title: profileSettingsAdminSectionTitle[languageCode],\n            md: \"12\",\n            className: \"ml-sm-auto mr-sm-auto\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }\n          })), /*#__PURE__*/React.createElement(Row, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 13\n            }\n          }, /*#__PURE__*/React.createElement(Col, {\n            lg: \"12\",\n            md: \"12\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 15\n            }\n          }, /*#__PURE__*/React.createElement(AssocDataInfo //assoc={this.state.assocDoc}\n          //componentDidMount={this.componentDidMount}\n          , {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 17\n            }\n          }))), /*#__PURE__*/React.createElement(Row, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 13\n            }\n          }, /*#__PURE__*/React.createElement(Col, {\n            lg: \"6\",\n            md: \"12\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 15\n            }\n          }, /*#__PURE__*/React.createElement(ExportAssocData, {\n            user: this.state.userDoc,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 17\n            }\n          }))));\n        }\n      }\n    }\n  }]);\n\n  return AdminSettings;\n}(React.Component);\n\nexport default AdminSettings;","map":{"version":3,"sources":["C:/Users/User/Desktop/Ambiente de Trabalho/Universidade/Ano 3/Semestre 2/PI/Projeto/repos/pi-assoc-pais/develop/src/views/AdminSettings.js"],"names":["React","Container","Row","Col","Button","DropdownItem","PageTitle","Link","Redirect","firebase_auth","languageCode","parentsParameters","profileSettingsAdminSectionTitle","profileSettingsPageTitle","loadingInfo","ExportAssocData","getAssocDoc","AssocDataInfo","AdminSettings","props","localUser","JSON","parse","window","localStorage","getItem","userEmail","userDoc","EMAIL","state","assocDoc","_isMounted","setState","console","log","currentUser","Object","keys","length","display","justifyContent","alignContent","alignItems","position","left","top","transform","ADMIN","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {Container, Row, Col, Button, DropdownItem} from \"shards-react\";\r\n\r\nimport PageTitle from \"../components/common/PageTitle\";\r\nimport {Link, Redirect} from \"react-router-dom\";\r\nimport { firebase_auth } from \"../firebase-config\";\r\nimport { languageCode, parentsParameters } from \"../utils/general_utils\";\r\nimport {\r\n  profileSettingsAdminSectionTitle,\r\n  profileSettingsPageTitle\r\n} from \"../utils/page_titles_strings\";\r\nimport { loadingInfo } from \"../utils/messages_strings\";\r\nimport ExportAssocData from \"../components/profile/ExportAssocData\";\r\nimport {getAssocDoc} from \"../firebase_scripts/get_assoc_info\";\r\nimport AssocDataInfo from \"../components/profile/AssocDataInfo\";\r\n\r\nclass AdminSettings extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n\r\n    let userEmail = null;\r\n    let userDoc = null;\r\n\r\n    if(localUser!=null){\r\n      userEmail = localUser[parentsParameters.EMAIL[languageCode]];\r\n      userDoc = localUser;\r\n    }\r\n\r\n    this.state = {\r\n      userEmail: userEmail,\r\n      userDoc: userDoc,\r\n      assocDoc : null\r\n    };\r\n\r\n\r\n      //this.componentDidMount = this.componentDidMount.bind(this);\r\n  }\r\n\r\n  /*********************************** LIFECYCLE ***********************************/\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n\r\n    const localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n    if(localUser!=null){\r\n      this.setState({userDoc : localUser});\r\n    }\r\n\r\n    console.log(\"atualizei-me!\");\r\n    /*if(updating){\r\n      const localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\r\n      if(localUser!=null){\r\n        this.setState({userDoc : localUser});\r\n      }\r\n      const localAssocDoc = JSON.parse(window.localStorage.getItem(\"assocDoc\"));\r\n      if(localAssocDoc!=null){\r\n        this.setState({assocDoc: localAssocDoc});\r\n      }\r\n    }\r\n\r\n    else{\r\n      const localAssocDoc = JSON.parse(window.localStorage.getItem(\"assocDoc\"));\r\n      if(localAssocDoc!=null){\r\n        this.setState({assocDoc: localAssocDoc});\r\n      }\r\n      else{\r\n        const promise = getAssocDoc();\r\n        promise\r\n          .then(doc => {\r\n            if (!doc.exists) {\r\n              console.log('No assotiation document found!');\r\n            }\r\n            else {\r\n              const data = doc.data();\r\n              window.localStorage.setItem(\"assocDoc\", JSON.stringify(data));\r\n              this.setState({\r\n                assocDoc: localAssocDoc\r\n              });\r\n            }\r\n          })\r\n          .catch(err => {\r\n            console.log('Error getting document', err);\r\n          });\r\n      }\r\n    }*/\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  /*********************************** HANDLERS ***********************************/\r\n\r\n\r\n\r\n  render() {\r\n    if (this.state.userEmail == null || firebase_auth.currentUser == null) {\r\n      return <Redirect to=\"/login\" />;\r\n    }\r\n    else if (this.state.userDoc == null || Object.keys(this.state.userDoc).length === 0 /*|| this.state.assocDoc == null*/) {\r\n      return (\r\n        <Container fluid className=\"main-content-container px-4\">\r\n          {/*<Row noGutters className=\"page-header py-4\">\r\n            <PageTitle\r\n              title={profileSettingsAdminSectionTitle[languageCode]}\r\n              md=\"12\"\r\n              className=\"ml-sm-auto mr-sm-auto\"\r\n            />\r\n          </Row>*/}\r\n          <Row\r\n            fluid\r\n            style={{\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              alignContent: \"center\",\r\n              alignItems: \"center\",\r\n              position: \"absolute\",\r\n              left: \"50%\",\r\n              top: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n            }}\r\n          >\r\n            <h2>{loadingInfo[languageCode]}</h2>\r\n          </Row>\r\n        </Container>\r\n      );\r\n    }\r\n    else {\r\n      // if not admin, cannot see the page\r\n      if(!this.state.userDoc[parentsParameters.ADMIN[languageCode]]){\r\n        return <Redirect to=\"/profile\" />;\r\n      }\r\n      else{\r\n        return (\r\n          <Container fluid className=\"main-content-container px-4\">\r\n            <Row noGutters className=\"page-header py-4\">\r\n              <PageTitle\r\n                title={profileSettingsAdminSectionTitle[languageCode]}\r\n                md=\"12\"\r\n                className=\"ml-sm-auto mr-sm-auto\"\r\n              />\r\n            </Row>\r\n            <Row>\r\n              <Col lg=\"12\" md=\"12\">\r\n                <AssocDataInfo\r\n                  //assoc={this.state.assocDoc}\r\n                  //componentDidMount={this.componentDidMount}\r\n                />\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col lg=\"6\" md=\"12\">\r\n                <ExportAssocData\r\n                  user={this.state.userDoc}\r\n                />\r\n              </Col>\r\n            </Row>\r\n          </Container>\r\n        );\r\n      }\r\n\r\n    }\r\n  }\r\n}\r\n\r\nexport default AdminSettings;\r\n"]},"metadata":{},"sourceType":"module"}