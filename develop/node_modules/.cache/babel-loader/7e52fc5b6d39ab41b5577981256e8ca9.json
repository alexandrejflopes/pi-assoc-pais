{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { firebase_auth, firebaseConfig, firestore, storageRef } from \"../firebase-config\";\nimport { languageCode, newParametersEntities, newParametersInputTypes, newParametersTypes, parentsParameters, studentsParameters } from \"../utils/general_utils\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nfunction fetchUserDoc(_x) {\n  return _fetchUserDoc.apply(this, arguments);\n}\n\nfunction _fetchUserDoc() {\n  _fetchUserDoc = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15(email) {\n    var project_id, uri, request;\n    return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n      while (1) {\n        switch (_context15.prev = _context15.next) {\n          case 0:\n            console.log(\"profile email to fetch: \" + email);\n            project_id = firebaseConfig.projectId;\n            uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/getParent?\" + \"id=\" + encodeURIComponent(email); //console.log(\"profile uri: \" + uri);\n\n            request = /*#__PURE__*/function () {\n              var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n                var userDoc;\n                return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n                  while (1) {\n                    switch (_context14.prev = _context14.next) {\n                      case 0:\n                        userDoc = {};\n                        _context14.next = 3;\n                        return fetch(uri).then(function (resp) {\n                          return resp.json();\n                        }) // Transform the data into json\n                        .then(function (data) {\n                          console.log(\"user recebido -> \", JSON.stringify(data));\n                          var doc = data; // TODO: manter esta verficacao ate a cloud function já fazer isto\n                          // ignore deleted children, if any\n\n                          var educandos = doc[\"Educandos\"];\n                          var educandosFiltrados = educandos.filter(function (json) {\n                            return json[\"deleted\"] === false;\n                          });\n                          doc[\"Educandos\"] = educandosFiltrados;\n                          userDoc = doc;\n                        }).catch(function (error) {\n                          console.log(error);\n                        });\n\n                      case 3:\n                        return _context14.abrupt(\"return\", userDoc);\n\n                      case 4:\n                      case \"end\":\n                        return _context14.stop();\n                    }\n                  }\n                }, _callee14);\n              }));\n\n              return function request() {\n                return _ref14.apply(this, arguments);\n              };\n            }();\n\n            return _context15.abrupt(\"return\", request());\n\n          case 5:\n          case \"end\":\n            return _context15.stop();\n        }\n      }\n    }, _callee15);\n  }));\n  return _fetchUserDoc.apply(this, arguments);\n}\n\nfunction userLogOut() {\n  firebase_auth.signOut().then(function () {\n    // Sign-out successful.\n    // clear local storage\n    window.localStorage.removeItem(\"userDoc\");\n    window.localStorage.removeItem(\"newParamsInputTypes\");\n    window.localStorage.removeItem(\"assocDoc\");\n    window.localStorage.removeItem(\"admin\");\n    window.localStorage.removeItem(\"email\"); //window.localStorage.removeItem(\"emailForSignIn\");\n\n    window.location = \"/login\";\n  }).catch(function (error) {\n    // An error happened.\n    console.log(\"Error logging out: \" + error);\n  });\n}\n\nfunction getNewParams() {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/getAllNewParams\"; //console.log(\"new params uri: \" + uri);\n\n  var request = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var paramsDoc;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              paramsDoc = {};\n              _context.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                //console.log(\"paramsDoc recebido -> \", JSON.stringify(data));\n                paramsDoc = data;\n              }).catch(function (error) {\n                console.log(\"erro no fetch de params: \" + error);\n              });\n\n            case 3:\n              return _context.abrupt(\"return\", paramsDoc);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function request() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n\nfunction mapParamsToInputType(paramsDoc) {\n  var inputTypesDoc = {};\n  var parentParams = paramsDoc[newParametersEntities.parent[languageCode]];\n  var childParams = paramsDoc[newParametersEntities.student[languageCode]];\n  var parentParamsTypes = {};\n  var childParamsTypes = {};\n\n  if (parentParams != null) {\n    for (var p in parentParams) {\n      if (parentParams[p] === newParametersTypes.TEXT[languageCode]) {\n        var inputType = newParametersInputTypes.TEXT.type;\n        var inputStep = newParametersInputTypes.TEXT.step;\n        parentParamsTypes[p] = {\n          type: inputType,\n          step: inputStep\n        };\n      } else if (parentParams[p] === newParametersTypes.INT[languageCode]) {\n        var _inputType = newParametersInputTypes.INT.type;\n        var _inputStep = newParametersInputTypes.INT.step;\n        parentParamsTypes[p] = {\n          type: _inputType,\n          step: _inputStep\n        };\n      } else if (parentParams[p] === newParametersTypes.FLOAT[languageCode]) {\n        var _inputType2 = newParametersInputTypes.FLOAT.type;\n        var _inputStep2 = newParametersInputTypes.FLOAT.step;\n        parentParamsTypes[p] = {\n          type: _inputType2,\n          step: _inputStep2\n        };\n      }\n    }\n\n    inputTypesDoc[newParametersEntities.parent[languageCode]] = parentParamsTypes;\n  }\n\n  if (childParams != null) {\n    for (var _p in childParams) {\n      if (childParams[_p] === newParametersTypes.TEXT[languageCode]) {\n        var _inputType3 = newParametersInputTypes.TEXT.type;\n        var _inputStep3 = newParametersInputTypes.TEXT.step;\n        childParamsTypes[_p] = {\n          type: _inputType3,\n          step: _inputStep3\n        };\n      } else if (childParams[_p] === newParametersTypes.INT[languageCode]) {\n        var _inputType4 = newParametersInputTypes.INT.type;\n        var _inputStep4 = newParametersInputTypes.INT.step;\n        childParamsTypes[_p] = {\n          type: _inputType4,\n          step: _inputStep4\n        };\n      } else if (childParams[_p] === newParametersTypes.FLOAT[languageCode]) {\n        var _inputType5 = newParametersInputTypes.FLOAT.type;\n        var _inputStep5 = newParametersInputTypes.FLOAT.step;\n        childParamsTypes[_p] = {\n          type: _inputType5,\n          step: _inputStep5\n        };\n      }\n    }\n\n    inputTypesDoc[newParametersEntities.student[languageCode]] = childParamsTypes;\n  } // like:  {\"um parametro\":{\"type\":\"text\",\"step\":null},\"Pólo\":{\"type\":\"text\",\"step\":null},\"Modalidade\":{\"type\":\"text\",\"step\":null},\"Regime\":{\"type\":\"text\",\"step\":null},\"Grau\":{\"type\":\"number\",\"step\":\"1\"}}\n\n\n  return inputTypesDoc;\n}\n\nfunction updateEducando(parentEmail, educandoDoc, oldName) {\n  console.log(\"educandoDoc -> \" + JSON.stringify(educandoDoc));\n  var localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n  var children = localUser[parentsParameters.CHILDREN[languageCode]];\n\n  for (var i in children) {\n    var currentChild = children[i]; // find child with that name to update it\n\n    if (currentChild[studentsParameters.NAME[languageCode]] === oldName) {\n      children[i] = educandoDoc;\n      break;\n    }\n  }\n\n  var childrenDesignation = parentsParameters.CHILDREN[languageCode];\n\n  var newChildrenField = _defineProperty({}, childrenDesignation, children);\n\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/updateParent?\" + \"id=\" + parentEmail + \"&doc=\" + encodeURIComponent(JSON.stringify(newChildrenField));\n\n  var request = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var updatedParent;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              updatedParent = {};\n              _context2.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                console.log(\"parentUpdated no request update child -> \", JSON.stringify(data));\n                updatedParent = data;\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 3:\n              return _context2.abrupt(\"return\", updatedParent);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function request() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n\nfunction updateParent(parentEmail, parentDoc) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/updateParent?\" + \"id=\" + parentEmail + \"&doc=\" + encodeURIComponent(JSON.stringify(parentDoc));\n\n  var request = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var updatedParent;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              updatedParent = {};\n              _context3.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                console.log(\"parentUpdated no request update info -> \", JSON.stringify(data));\n                updatedParent = data;\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 3:\n              return _context3.abrupt(\"return\", updatedParent);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function request() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n\nfunction uploadProfilePhoto(photoFile) {\n  // unique file name\n  var newPhotoPath = \"profilePhotos/\" + uuidv4() + \"-\" + photoFile.name;\n  var newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n\nfunction uploadChildPhoto(photoFile) {\n  // unique file name\n  var newPhotoPath = \"childPhotos/\" + uuidv4() + \"-\" + photoFile.name;\n  var newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n\nfunction uploadAssocLogo(photoFile) {\n  // unique file name\n  var newPhotoPath = \"logo/\" + uuidv4() + \"-\" + photoFile.name;\n  var newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n/*\n * function to add a child to a parent\n * */\n\n\nfunction addEducandoToParent(parentEmail, newChild, photo) {\n  console.log(\"newChild received -> \" + JSON.stringify(newChild));\n  var childJson = newChild;\n  childJson[studentsParameters.PHOTO[languageCode]] = photo;\n  console.log(\"childJson with photo -> \" + JSON.stringify(childJson));\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/addEducando?\" + \"id=\" + parentEmail + \"&educando=\" + encodeURIComponent(JSON.stringify(childJson));\n\n  var request = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var updatedParent;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              updatedParent = {};\n              _context4.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                console.log(\"parentUpdated no request add child -> \", JSON.stringify(data));\n                updatedParent = data;\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 3:\n              return _context4.abrupt(\"return\", updatedParent);\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function request() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return request();\n  /*\n  let parentRef = firestore.collection('parents').doc(parentEmail);\n  const childrenDesignation = parentsParameters.CHILDREN[languageCode];\n   return parentRef.get()\n    .then((doc) => {\n      if (!doc.exists) {\n        console.log('No such document for parent <' + parentEmail + '> !');\n      }\n      else {\n        let parent = doc.data();\n         let children = parent[childrenDesignation];\n        console.log(\"children array -> \" + JSON.stringify(children));\n        children.push(childJson);\n        console.log(\"children novo -> \" + JSON.stringify(childJson));\n        parent[childrenDesignation] = children;\n        console.log(\"parent final -> \" + JSON.stringify(parent));\n         return parent;\n      }\n    })\n    .then((parent) => {\n      return parentRef.update({[childrenDesignation] : parent[childrenDesignation]})\n        .then(() => {return parent});\n    })\n    .catch((err) => {\n      console.log('Error getting parent <' + parentEmail + '> : ' + err);\n    });*/\n}\n\nfunction deleteEducandoFromParent(parentEmail, childName) {\n  console.log(\"childName to erase received -> \" + childName);\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/removeEducando?\" + \"id=\" + encodeURIComponent(parentEmail) + \"&nome_educando=\" + encodeURIComponent(childName);\n\n  var request = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var updatedParent;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              updatedParent = {};\n              _context5.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                //console.log(\"parentUpdated no request delete child -> \", JSON.stringify(data));\n                updatedParent = data;\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 3:\n              return _context5.abrupt(\"return\", updatedParent);\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function request() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return request();\n  /*let parentRef = firestore.collection('parents').doc(parentEmail);\n  const childrenDesignation = parentsParameters.CHILDREN[languageCode];\n   return parentRef.get()\n    .then((doc) => {\n      if (!doc.exists) {\n        console.log('No such document for parent <' + parentEmail + '> !');\n      }\n      else {\n        let parent = doc.data();\n         let children = parent[childrenDesignation];\n         for(let i in children){\n          const currentName = children[i][studentsParameters.NAME[languageCode]];\n          console.log(\"currentName -> \" + currentName);\n          if(currentName===childName){\n            console.log(\"SPLICE!\");\n            children.splice(i,1);\n            break;\n          }\n        }\n         console.log(\"children array novo -> \" + JSON.stringify(children));\n        parent[childrenDesignation] = children;\n        console.log(\"parent final -> \" + JSON.stringify(parent));\n         return parent;\n      }\n    })\n    .then((parent) => {\n      return parentRef.update({[childrenDesignation] : parent[childrenDesignation]})\n        .then(() => {return parent});\n    })\n    .catch((err) => {\n      console.log('Error getting parent <' + parentEmail + '> : ' + err);\n    });*/\n}\n/*\n * function to check if the current email exists in Firebase auth\n * */\n\n\nfunction emailExistsInFBAuth(email) {\n  return firebase_auth.fetchSignInMethodsForEmail(email).then(function (providers) {\n    // if no providers, then user does no exist\n    return !(!providers || providers.length === 0);\n  }).catch(function (e) {\n    return false;\n  });\n}\n/*\n * function to check if an email exists in DB\n * */\n\n\nfunction emailExistsInDB(email) {\n  console.log(\"email to check in DB: \" + email); // in case of, for some reason, the current email is not in the DB\n\n  var parentRef = firestore.collection(\"parents\").doc(email);\n  return parentRef.get().then(function (doc) {\n    console.log(\"doc para DB <\" + email + \">: \" + JSON.stringify(doc.data()));\n\n    if (!doc.exists) {\n      console.log(\"doc para <\" + email + \"> não existe\");\n      return false;\n    }\n\n    return true;\n  }).catch(function (error) {\n    console.log(\"erro para DB <\" + email + \">: \" + JSON.stringify(error));\n    return false;\n  });\n}\n\nfunction updateParentEmail(currentEmail, newEmail) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/alterParentEmail?\" + \"email=\" + encodeURIComponent(currentEmail) + \"&new_email=\" + encodeURIComponent(newEmail);\n\n  var request = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var updatedParent;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              updatedParent = {};\n              _context6.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into json\n              .then(function (data) {\n                console.log(\"parentUpdated no request update email -> \", JSON.stringify(data));\n                updatedParent = data;\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 3:\n              return _context6.abrupt(\"return\", updatedParent);\n\n            case 4:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function request() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * export PDF with parent data\n * */\n\n\nfunction exportParentToPDF(email) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/exportSingleParentPDF?\" + \"id=\" + encodeURIComponent(email);\n\n  var request = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      var file;\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              file = new Blob();\n              _context7.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.blob();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                console.log(\"Export PDF success\");\n                file = data;\n              }).catch(function (error) {\n                console.log(\"Export error: \" + error);\n              });\n\n            case 3:\n              return _context7.abrupt(\"return\", file);\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function request() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * export CSV with parent data\n * */\n\n\nfunction exportParentToCSV(email) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/exportSingleParentCSV?\" + \"id=\" + encodeURIComponent(email);\n\n  var request = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      var file;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              file = null;\n              _context8.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.blob();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                console.log(\"Export CSV success\");\n                file = data;\n              }).catch(function (error) {\n                console.log(\"Export error: \" + error);\n              });\n\n            case 3:\n              return _context8.abrupt(\"return\", file);\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function request() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * export all parents data to a CSV\n * */\n\n\nfunction exportAllParentsToCSV() {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/exportParentCSV\";\n\n  var request = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n      var file;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              file = null;\n              _context9.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.blob();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                console.log(\"Export parents CSV success\");\n                file = data;\n              }).catch(function (error) {\n                console.log(\"Export error: \" + error);\n              });\n\n            case 3:\n              return _context9.abrupt(\"return\", file);\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function request() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * export all children data to a CSV\n * */\n\n\nfunction exportAllChildrenToCSV() {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/exportEducandosCSV\";\n\n  var request = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n      var file;\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              file = null;\n              _context10.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.blob();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                console.log(\"Export children CSV success\");\n                file = data;\n              }).catch(function (error) {\n                console.log(\"Export error: \" + error);\n              });\n\n            case 3:\n              return _context10.abrupt(\"return\", file);\n\n            case 4:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    }));\n\n    return function request() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * export cases to PDF\n * */\n\n\nfunction exportAllCasosToPDF() {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/exportCasosPDF\";\n\n  var request = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n      var file;\n      return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              file = new Blob();\n              _context11.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.blob();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                console.log(\"Export PDF success\");\n                file = data;\n              }).catch(function (error) {\n                console.log(\"Export error: \" + error);\n              });\n\n            case 3:\n              return _context11.abrupt(\"return\", file);\n\n            case 4:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }));\n\n    return function request() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * delete user account\n * */\n\n\nfunction deleteAccount(email) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/deleteAccount?\" + \"email=\" + encodeURIComponent(email);\n\n  var request = /*#__PURE__*/function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n      var deletedParent;\n      return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              deletedParent = {};\n              _context12.next = 3;\n              return fetch(uri).then(function (resp) {\n                return resp.json();\n              }) // Transform the data into blob / file\n              .then(function (data) {\n                if (data.error == null) {\n                  console.log(\"Parent removed successfully\");\n                } else {\n                  console.log(data.error);\n                }\n\n                deletedParent = data;\n              }).catch(function (error) {\n                console.log(\"Delete account error: \" + error);\n              });\n\n            case 3:\n              return _context12.abrupt(\"return\", deletedParent);\n\n            case 4:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12);\n    }));\n\n    return function request() {\n      return _ref12.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n\nfunction deleteAccountEmailNotification(nome, email) {\n  var project_id = firebaseConfig.projectId;\n  var uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/sendAccountEliminationEmail?\" + \"email=\" + email + \"&\" + \"nome=\" + nome;\n\n  var request = /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              _context13.next = 2;\n              return fetch(uri).then().catch(function (error) {\n                console.log(\"Error sending account delete email: \" + error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13);\n    }));\n\n    return function request() {\n      return _ref13.apply(this, arguments);\n    };\n  }();\n\n  return request();\n}\n/*\n * send email to parent to notify it was imported to platform\n */\n\n\nfunction sendChangeEmailAuth(_x2, _x3) {\n  return _sendChangeEmailAuth.apply(this, arguments);\n}\n\nfunction _sendChangeEmailAuth() {\n  _sendChangeEmailAuth = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(nome, email) {\n    var project_id, uri, request;\n    return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n      while (1) {\n        switch (_context17.prev = _context17.next) {\n          case 0:\n            project_id = firebaseConfig.projectId;\n            uri = \"https://us-central1-\" + project_id + \".cloudfunctions.net/api/sendAuthenticationEmailAfterEmailChange?\" + \"email=\" + encodeURIComponent(email) + \"&\" + \"nome=\" + encodeURIComponent(nome);\n            window.localStorage.setItem(\"emailForSignIn\", email);\n\n            request = /*#__PURE__*/function () {\n              var _ref15 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n                return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n                  while (1) {\n                    switch (_context16.prev = _context16.next) {\n                      case 0:\n                        _context16.next = 2;\n                        return fetch(uri).then(function () {}).catch(function (error) {\n                          console.log(\"Error sending newEmail email: \" + error);\n                        });\n\n                      case 2:\n                      case \"end\":\n                        return _context16.stop();\n                    }\n                  }\n                }, _callee16);\n              }));\n\n              return function request() {\n                return _ref15.apply(this, arguments);\n              };\n            }();\n\n            return _context17.abrupt(\"return\", request());\n\n          case 5:\n          case \"end\":\n            return _context17.stop();\n        }\n      }\n    }, _callee17);\n  }));\n  return _sendChangeEmailAuth.apply(this, arguments);\n}\n\nexport { fetchUserDoc, userLogOut, mapParamsToInputType, getNewParams, addEducandoToParent, deleteEducandoFromParent, updateEducando, updateParent, uploadProfilePhoto, uploadChildPhoto, emailExistsInFBAuth, emailExistsInDB, updateParentEmail, sendChangeEmailAuth, exportParentToPDF, exportParentToCSV, exportAllParentsToCSV, exportAllChildrenToCSV, deleteAccount, uploadAssocLogo, exportAllCasosToPDF, deleteAccountEmailNotification };","map":{"version":3,"sources":["C:/Users/User/Desktop/Ambiente de Trabalho/Universidade/Ano 3/Semestre 2/PI/Projeto/repos/pi-assoc-pais/develop/src/firebase_scripts/profile_functions.js"],"names":["firebase_auth","firebaseConfig","firestore","storageRef","languageCode","newParametersEntities","newParametersInputTypes","newParametersTypes","parentsParameters","studentsParameters","v4","uuidv4","fetchUserDoc","email","console","log","project_id","projectId","uri","encodeURIComponent","request","userDoc","fetch","then","resp","json","data","JSON","stringify","doc","educandos","educandosFiltrados","filter","catch","error","userLogOut","signOut","window","localStorage","removeItem","location","getNewParams","paramsDoc","mapParamsToInputType","inputTypesDoc","parentParams","parent","childParams","student","parentParamsTypes","childParamsTypes","p","TEXT","inputType","type","inputStep","step","INT","FLOAT","updateEducando","parentEmail","educandoDoc","oldName","localUser","parse","getItem","children","CHILDREN","i","currentChild","NAME","childrenDesignation","newChildrenField","updatedParent","updateParent","parentDoc","uploadProfilePhoto","photoFile","newPhotoPath","name","newPhotoRef","child","put","uploadChildPhoto","uploadAssocLogo","addEducandoToParent","newChild","photo","childJson","PHOTO","deleteEducandoFromParent","childName","emailExistsInFBAuth","fetchSignInMethodsForEmail","providers","length","e","emailExistsInDB","parentRef","collection","get","exists","updateParentEmail","currentEmail","newEmail","exportParentToPDF","file","Blob","blob","exportParentToCSV","exportAllParentsToCSV","exportAllChildrenToCSV","exportAllCasosToPDF","deleteAccount","deletedParent","deleteAccountEmailNotification","nome","sendChangeEmailAuth","setItem"],"mappings":"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","sourcesContent":["import {\n  firebase_auth,\n  firebaseConfig,\n  firestore,\n  storageRef,\n} from \"../firebase-config\";\nimport {\n  languageCode,\n  newParametersEntities,\n  newParametersInputTypes,\n  newParametersTypes,\n  parentsParameters,\n  studentsParameters,\n} from \"../utils/general_utils\";\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nasync function fetchUserDoc(email) {\n  console.log(\"profile email to fetch: \" + email);\n\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/getParent?\" +\n    \"id=\" +\n    encodeURIComponent(email);\n\n  //console.log(\"profile uri: \" + uri);\n\n  const request = async () => {\n    let userDoc = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        console.log(\"user recebido -> \", JSON.stringify(data));\n        let doc = data;\n        // TODO: manter esta verficacao ate a cloud function já fazer isto\n        // ignore deleted children, if any\n        let educandos = doc[\"Educandos\"];\n        let educandosFiltrados = educandos.filter(json => json[\"deleted\"] === false);\n        doc[\"Educandos\"] = educandosFiltrados;\n        userDoc = doc;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return userDoc;\n  };\n\n  return request();\n}\n\nfunction userLogOut() {\n  firebase_auth\n    .signOut()\n    .then(function () {\n      // Sign-out successful.\n      // clear local storage\n      window.localStorage.removeItem(\"userDoc\");\n      window.localStorage.removeItem(\"newParamsInputTypes\");\n      window.localStorage.removeItem(\"assocDoc\");\n      window.localStorage.removeItem(\"admin\");\n      window.localStorage.removeItem(\"email\");\n      //window.localStorage.removeItem(\"emailForSignIn\");\n      window.location = \"/login\";\n    })\n    .catch(function (error) {\n      // An error happened.\n      console.log(\"Error logging out: \" + error);\n    });\n}\n\nfunction getNewParams() {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/getAllNewParams\";\n\n  //console.log(\"new params uri: \" + uri);\n\n  const request = async () => {\n    let paramsDoc = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        //console.log(\"paramsDoc recebido -> \", JSON.stringify(data));\n        paramsDoc = data;\n      })\n      .catch(function (error) {\n        console.log(\"erro no fetch de params: \" + error);\n      });\n\n    return paramsDoc;\n  };\n\n  return request();\n}\n\nfunction mapParamsToInputType(paramsDoc) {\n  let inputTypesDoc = {};\n  let parentParams = paramsDoc[newParametersEntities.parent[languageCode]];\n  let childParams = paramsDoc[newParametersEntities.student[languageCode]];\n\n  let parentParamsTypes = {};\n  let childParamsTypes = {};\n\n  if (parentParams != null) {\n    for (let p in parentParams) {\n      if (parentParams[p] === newParametersTypes.TEXT[languageCode]) {\n        const inputType = newParametersInputTypes.TEXT.type;\n        const inputStep = newParametersInputTypes.TEXT.step;\n        parentParamsTypes[p] = { type: inputType, step: inputStep };\n      } else if (parentParams[p] === newParametersTypes.INT[languageCode]) {\n        const inputType = newParametersInputTypes.INT.type;\n        const inputStep = newParametersInputTypes.INT.step;\n        parentParamsTypes[p] = { type: inputType, step: inputStep };\n      } else if (parentParams[p] === newParametersTypes.FLOAT[languageCode]) {\n        const inputType = newParametersInputTypes.FLOAT.type;\n        const inputStep = newParametersInputTypes.FLOAT.step;\n        parentParamsTypes[p] = { type: inputType, step: inputStep };\n      }\n    }\n\n    inputTypesDoc[\n      newParametersEntities.parent[languageCode]\n    ] = parentParamsTypes;\n  }\n\n  if (childParams != null) {\n    for (let p in childParams) {\n      if (childParams[p] === newParametersTypes.TEXT[languageCode]) {\n        const inputType = newParametersInputTypes.TEXT.type;\n        const inputStep = newParametersInputTypes.TEXT.step;\n        childParamsTypes[p] = { type: inputType, step: inputStep };\n      } else if (childParams[p] === newParametersTypes.INT[languageCode]) {\n        const inputType = newParametersInputTypes.INT.type;\n        const inputStep = newParametersInputTypes.INT.step;\n        childParamsTypes[p] = { type: inputType, step: inputStep };\n      } else if (childParams[p] === newParametersTypes.FLOAT[languageCode]) {\n        const inputType = newParametersInputTypes.FLOAT.type;\n        const inputStep = newParametersInputTypes.FLOAT.step;\n        childParamsTypes[p] = { type: inputType, step: inputStep };\n      }\n    }\n\n    inputTypesDoc[\n      newParametersEntities.student[languageCode]\n    ] = childParamsTypes;\n  }\n\n  // like:  {\"um parametro\":{\"type\":\"text\",\"step\":null},\"Pólo\":{\"type\":\"text\",\"step\":null},\"Modalidade\":{\"type\":\"text\",\"step\":null},\"Regime\":{\"type\":\"text\",\"step\":null},\"Grau\":{\"type\":\"number\",\"step\":\"1\"}}\n  return inputTypesDoc;\n}\n\nfunction updateEducando(parentEmail, educandoDoc, oldName) {\n  console.log(\"educandoDoc -> \" + JSON.stringify(educandoDoc));\n\n  let localUser = JSON.parse(window.localStorage.getItem(\"userDoc\"));\n  let children = localUser[parentsParameters.CHILDREN[languageCode]];\n\n  for (let i in children) {\n    let currentChild = children[i];\n    // find child with that name to update it\n    if (currentChild[studentsParameters.NAME[languageCode]] === oldName) {\n      children[i] = educandoDoc;\n      break;\n    }\n  }\n  const childrenDesignation = parentsParameters.CHILDREN[languageCode];\n  const newChildrenField = { [childrenDesignation]: children };\n\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/updateParent?\" +\n    \"id=\" +\n    parentEmail +\n    \"&doc=\" +\n    encodeURIComponent(JSON.stringify(newChildrenField));\n\n  const request = async () => {\n    let updatedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        console.log(\n          \"parentUpdated no request update child -> \",\n          JSON.stringify(data)\n        );\n        updatedParent = data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return updatedParent;\n  };\n\n  return request();\n}\n\nfunction updateParent(parentEmail, parentDoc) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/updateParent?\" +\n    \"id=\" +\n    parentEmail +\n    \"&doc=\" +\n    encodeURIComponent(JSON.stringify(parentDoc));\n\n  const request = async () => {\n    let updatedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        console.log(\n          \"parentUpdated no request update info -> \",\n          JSON.stringify(data)\n        );\n        updatedParent = data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return updatedParent;\n  };\n\n  return request();\n}\n\nfunction uploadProfilePhoto(photoFile) {\n  // unique file name\n  const newPhotoPath = \"profilePhotos/\" + uuidv4() + \"-\" + photoFile.name;\n  const newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n\nfunction uploadChildPhoto(photoFile) {\n  // unique file name\n  const newPhotoPath = \"childPhotos/\" + uuidv4() + \"-\" + photoFile.name;\n  const newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n\nfunction uploadAssocLogo(photoFile) {\n  // unique file name\n  const newPhotoPath = \"logo/\" + uuidv4() + \"-\" + photoFile.name;\n  const newPhotoRef = storageRef.child(newPhotoPath);\n  return newPhotoRef.put(photoFile);\n}\n\n/*\n * function to add a child to a parent\n * */\nfunction addEducandoToParent(parentEmail, newChild, photo) {\n  console.log(\"newChild received -> \" + JSON.stringify(newChild));\n\n  let childJson = newChild;\n  childJson[studentsParameters.PHOTO[languageCode]] = photo;\n\n  console.log(\"childJson with photo -> \" + JSON.stringify(childJson));\n\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/addEducando?\" +\n    \"id=\" +\n    parentEmail +\n    \"&educando=\" +\n    encodeURIComponent(JSON.stringify(childJson));\n\n  const request = async () => {\n    let updatedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        console.log(\n          \"parentUpdated no request add child -> \",\n          JSON.stringify(data)\n        );\n        updatedParent = data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return updatedParent;\n  };\n\n  return request();\n\n  /*\n  let parentRef = firestore.collection('parents').doc(parentEmail);\n  const childrenDesignation = parentsParameters.CHILDREN[languageCode];\n\n  return parentRef.get()\n    .then((doc) => {\n      if (!doc.exists) {\n        console.log('No such document for parent <' + parentEmail + '> !');\n      }\n      else {\n        let parent = doc.data();\n\n        let children = parent[childrenDesignation];\n        console.log(\"children array -> \" + JSON.stringify(children));\n        children.push(childJson);\n        console.log(\"children novo -> \" + JSON.stringify(childJson));\n        parent[childrenDesignation] = children;\n        console.log(\"parent final -> \" + JSON.stringify(parent));\n\n        return parent;\n      }\n    })\n    .then((parent) => {\n      return parentRef.update({[childrenDesignation] : parent[childrenDesignation]})\n        .then(() => {return parent});\n    })\n    .catch((err) => {\n      console.log('Error getting parent <' + parentEmail + '> : ' + err);\n    });*/\n}\n\nfunction deleteEducandoFromParent(parentEmail, childName) {\n  console.log(\"childName to erase received -> \" + childName);\n\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/removeEducando?\" +\n    \"id=\" +\n    encodeURIComponent(parentEmail) +\n    \"&nome_educando=\" +\n    encodeURIComponent(childName);\n\n  const request = async () => {\n    let updatedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        //console.log(\"parentUpdated no request delete child -> \", JSON.stringify(data));\n        updatedParent = data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return updatedParent;\n  };\n\n  return request();\n\n  /*let parentRef = firestore.collection('parents').doc(parentEmail);\n  const childrenDesignation = parentsParameters.CHILDREN[languageCode];\n\n  return parentRef.get()\n    .then((doc) => {\n      if (!doc.exists) {\n        console.log('No such document for parent <' + parentEmail + '> !');\n      }\n      else {\n        let parent = doc.data();\n\n        let children = parent[childrenDesignation];\n\n        for(let i in children){\n          const currentName = children[i][studentsParameters.NAME[languageCode]];\n          console.log(\"currentName -> \" + currentName);\n          if(currentName===childName){\n            console.log(\"SPLICE!\");\n            children.splice(i,1);\n            break;\n          }\n        }\n\n        console.log(\"children array novo -> \" + JSON.stringify(children));\n        parent[childrenDesignation] = children;\n        console.log(\"parent final -> \" + JSON.stringify(parent));\n\n        return parent;\n      }\n    })\n    .then((parent) => {\n      return parentRef.update({[childrenDesignation] : parent[childrenDesignation]})\n        .then(() => {return parent});\n    })\n    .catch((err) => {\n      console.log('Error getting parent <' + parentEmail + '> : ' + err);\n    });*/\n}\n\n/*\n * function to check if the current email exists in Firebase auth\n * */\n\nfunction emailExistsInFBAuth(email) {\n  return firebase_auth\n    .fetchSignInMethodsForEmail(email)\n    .then((providers) => {\n      // if no providers, then user does no exist\n      return !(!providers || providers.length === 0);\n    })\n    .catch((e) => {\n      return false;\n    });\n}\n\n/*\n * function to check if an email exists in DB\n * */\nfunction emailExistsInDB(email) {\n  console.log(\"email to check in DB: \" + email);\n\n  // in case of, for some reason, the current email is not in the DB\n  let parentRef = firestore.collection(\"parents\").doc(email);\n\n  return parentRef\n    .get()\n    .then((doc) => {\n      console.log(\"doc para DB <\" + email + \">: \" + JSON.stringify(doc.data()));\n      if (!doc.exists) {\n        console.log(\"doc para <\" + email + \"> não existe\");\n        return false;\n      }\n      return true;\n    })\n    .catch((error) => {\n      console.log(\"erro para DB <\" + email + \">: \" + JSON.stringify(error));\n      return false;\n    });\n}\n\nfunction updateParentEmail(currentEmail, newEmail) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/alterParentEmail?\" +\n    \"email=\" +\n    encodeURIComponent(currentEmail) +\n    \"&new_email=\" +\n    encodeURIComponent(newEmail);\n\n  const request = async () => {\n    let updatedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into json\n      .then(function (data) {\n        console.log(\n          \"parentUpdated no request update email -> \",\n          JSON.stringify(data)\n        );\n        updatedParent = data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    return updatedParent;\n  };\n\n  return request();\n}\n\n/*\n * export PDF with parent data\n * */\nfunction exportParentToPDF(email) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/exportSingleParentPDF?\" +\n    \"id=\" +\n    encodeURIComponent(email);\n\n  const request = async () => {\n    let file = new Blob();\n    await fetch(uri)\n      .then((resp) => resp.blob()) // Transform the data into blob / file\n      .then(function (data) {\n        console.log(\"Export PDF success\");\n        file = data;\n      })\n      .catch(function (error) {\n        console.log(\"Export error: \" + error);\n      });\n\n    return file;\n  };\n\n  return request();\n}\n\n/*\n * export CSV with parent data\n * */\nfunction exportParentToCSV(email) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/exportSingleParentCSV?\" +\n    \"id=\" +\n    encodeURIComponent(email);\n\n  const request = async () => {\n    let file = null;\n    await fetch(uri)\n      .then((resp) => resp.blob()) // Transform the data into blob / file\n      .then(function (data) {\n        console.log(\"Export CSV success\");\n        file = data;\n      })\n      .catch(function (error) {\n        console.log(\"Export error: \" + error);\n      });\n\n    return file;\n  };\n\n  return request();\n}\n\n/*\n * export all parents data to a CSV\n * */\nfunction exportAllParentsToCSV() {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/exportParentCSV\";\n\n  const request = async () => {\n    let file = null;\n    await fetch(uri)\n      .then((resp) => resp.blob()) // Transform the data into blob / file\n      .then(function (data) {\n        console.log(\"Export parents CSV success\");\n        file = data;\n      })\n      .catch(function (error) {\n        console.log(\"Export error: \" + error);\n      });\n\n    return file;\n  };\n\n  return request();\n}\n\n/*\n * export all children data to a CSV\n * */\nfunction exportAllChildrenToCSV() {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/exportEducandosCSV\";\n\n  const request = async () => {\n    let file = null;\n    await fetch(uri)\n      .then((resp) => resp.blob()) // Transform the data into blob / file\n      .then(function (data) {\n        console.log(\"Export children CSV success\");\n        file = data;\n      })\n      .catch(function (error) {\n        console.log(\"Export error: \" + error);\n      });\n\n    return file;\n  };\n\n  return request();\n}\n\n/*\n * export cases to PDF\n * */\nfunction exportAllCasosToPDF() {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/exportCasosPDF\";\n\n  const request = async () => {\n    let file = new Blob();\n    await fetch(uri)\n      .then((resp) => resp.blob()) // Transform the data into blob / file\n      .then(function (data) {\n        console.log(\"Export PDF success\");\n        file = data;\n      })\n      .catch(function (error) {\n        console.log(\"Export error: \" + error);\n      });\n\n    return file;\n  };\n\n  return request();\n}\n\n/*\n * delete user account\n * */\nfunction deleteAccount(email) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/deleteAccount?\" +\n    \"email=\" +\n    encodeURIComponent(email);\n\n  const request = async () => {\n    let deletedParent = {};\n    await fetch(uri)\n      .then((resp) => resp.json()) // Transform the data into blob / file\n      .then(function (data) {\n        if(data.error==null){\n          console.log(\"Parent removed successfully\");\n        }\n        else{\n          console.log(data.error);\n        }\n        deletedParent = data;\n      })\n      .catch(function (error) {\n        console.log(\"Delete account error: \" + error);\n      });\n\n    return deletedParent;\n  };\n\n  return request();\n}\n\nfunction deleteAccountEmailNotification(nome, email) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/sendAccountEliminationEmail?\" +\n    \"email=\" +\n    email +\n    \"&\" +\n    \"nome=\" +\n    nome;\n\n  const request = async () => {\n    await fetch(uri)\n      .then()\n      .catch(function (error) {\n        console.log(\"Error sending account delete email: \" + error);\n      });\n  };\n\n  return request();\n}\n\n/*\n * send email to parent to notify it was imported to platform\n */\nasync function sendChangeEmailAuth(nome, email) {\n  const project_id = firebaseConfig.projectId;\n  let uri =\n    \"https://us-central1-\" +\n    project_id +\n    \".cloudfunctions.net/api/sendAuthenticationEmailAfterEmailChange?\" +\n    \"email=\" +\n    encodeURIComponent(email) +\n    \"&\" +\n    \"nome=\" +\n    encodeURIComponent(nome);\n\n  window.localStorage.setItem(\"emailForSignIn\", email);\n\n  const request = async () => {\n    await fetch(uri)\n      .then(() => {})\n      .catch(function (error) {\n        console.log(\"Error sending newEmail email: \" + error);\n      });\n  };\n\n  return request();\n}\n\nexport {\n  fetchUserDoc,\n  userLogOut,\n  mapParamsToInputType,\n  getNewParams,\n  addEducandoToParent,\n  deleteEducandoFromParent,\n  updateEducando,\n  updateParent,\n  uploadProfilePhoto,\n  uploadChildPhoto,\n  emailExistsInFBAuth,\n  emailExistsInDB,\n  updateParentEmail,\n  sendChangeEmailAuth,\n  exportParentToPDF,\n  exportParentToCSV,\n  exportAllParentsToCSV,\n  exportAllChildrenToCSV,\n  deleteAccount,\n  uploadAssocLogo,\n  exportAllCasosToPDF,\n  deleteAccountEmailNotification,\n};\n"]},"metadata":{},"sourceType":"module"}