{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\Ambiente de Trabalho\\\\Universidade\\\\Ano 3\\\\Semestre 2\\\\PI\\\\Projeto\\\\repos\\\\pi-assoc-pais\\\\develop\\\\src\\\\components\\\\payment-page\\\\PaymentPage.js\";\nimport React, { Component, Fragment } from \"react\";\nimport { Col, Row, Button, Form, FormGroup, FormFeedback, Input } from \"reactstrap\";\nimport { FormInput } from \"shards-react\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport BlockUi from \"react-block-ui\";\nimport { Loader } from \"react-loaders\";\nimport { toast, Bounce } from \"react-toastify\";\nimport { firestore, firebase_auth, firebase } from \"../../firebase-config\"; //import * as UsersService from \"../../services/users/api_user\";\n\nimport CostumForm from \"../../common/Form/form\";\nimport bg1 from \"../../assets/mother.png\";\nimport { languageCode, parentsParameters } from \"../../utils/general_utils\";\nimport { errorSignOut } from \"../../utils/messages_strings\";\n\nvar Payment_Page = /*#__PURE__*/function (_CostumForm) {\n  _inherits(Payment_Page, _CostumForm);\n\n  var _super = _createSuper(Payment_Page);\n\n  function Payment_Page(props) {\n    var _this;\n\n    _classCallCheck(this, Payment_Page);\n\n    _this = _super.call(this, props);\n\n    _this.doSubmit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n        var Email, this_, ref, docPart;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                Email = _this.state.Email;\n                this_ = _assertThisInitialized(_this); //Escrever na base de dados no doc parents/<email> que firstPayment=true;\n\n                ref = firestore.collection(\"parents\").doc(Email);\n                docPart = {};\n                docPart[parentsParameters.PAYED_FEE[languageCode]] = true;\n                return _context.abrupt(\"return\", ref.update(docPart).then(function () {\n                  console.log(\"Document successfully updated!\");\n                  var refresh = /*#__PURE__*/React.createElement(Redirect, {\n                    to: {\n                      pathname: \"/payment\",\n                      state: {\n                        Email: Email,\n                        payment: true\n                      }\n                    },\n                    __self: this,\n                    __source: {\n                      fileName: _jsxFileName,\n                      lineNumber: 107,\n                      columnNumber: 11\n                    }\n                  });\n                  this_.setState({\n                    payment: true,\n                    refresh: refresh\n                  });\n                }).catch(function (error) {\n                  // The document probably doesn't exist.\n                  //console.error(\"Error updating document: \", error);\n                  alert(\"Erro no envio, por favor, volte a tentar\");\n                }));\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    var json = JSON.stringify(_this.props);\n    var email = _this.props.email;\n    var payment = _this.props.payment;\n\n    if (email == null) {\n      email = \"redirect\";\n    }\n\n    _this.state = {\n      blocking: true,\n      Email: email,\n      payment: payment,\n      errors: {},\n      refresh: null\n    };\n    _this.LoginReturn = _this.LoginReturn.bind(_assertThisInitialized(_this)); //console.log(\"JSON: \" + json);\n    //console.log(\"state: \" + JSON.stringify(this.props.match.params));\n\n    return _this;\n  }\n  /*********************************** LIFECYCLE ***********************************/\n\n\n  _createClass(Payment_Page, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true; // const user = UsersService.getCurrentUser();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n    /*********************************** HANDLERS ***********************************/\n\n  }, {\n    key: \"LoginReturn\",\n    value: function LoginReturn() {\n      firebase_auth.signOut().then(function () {\n        // Sign-out successful.\n        // clear local storage\n        window.localStorage.removeItem(\"userDoc\");\n        window.localStorage.removeItem(\"newParamsInputTypes\");\n        window.localStorage.removeItem(\"assocDoc\");\n        window.localStorage.removeItem(\"admin\");\n        window.localStorage.removeItem(\"email\");\n        window.location = \"/login\";\n      }).catch(function (error) {\n        // An error happened.\n        var message = errorSignOut[languageCode];\n        toast.configure();\n        toast(message, {\n          transition: Bounce,\n          closeButton: true,\n          autoClose: 2000,\n          position: \"top-right\",\n          type: \"error\"\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.Email === \"redirect\") {\n        return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/login\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 14\n          }\n        });\n      } else {\n        return /*#__PURE__*/React.createElement(Fragment, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(BlockUi, {\n          tag: \"div\",\n          blocking: this.state.blocking,\n          loader: /*#__PURE__*/React.createElement(Loader, {\n            active: true,\n            type: \"line-scale-pulse-out\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 21\n            }\n          }),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 11\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"h-100 bg-animation\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"d-flex h-100 justify-content-center align-items-center\",\n          style: {\n            background: \"url(\" + bg1 + \")\",\n            backgroundRepeat: \"no-repeat\",\n            backgroundSize: \"cover\",\n            backgroundPosition: \"center center\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(Col, {\n          md: \"8\",\n          className: \"mx-auto app-login-box\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"modal-dialog w-100 mx-auto\",\n          style: {\n            boxShadow: \"0px 1px 10px 0px rgba(52, 58, 64, 0.3)\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"modal-content\",\n          style: {\n            border: \"none\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"modal-body\",\n          style: {\n            padding: \"2.5rem\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"h6 modal-title text-center mb-4\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          className: \"mb-4\",\n          src: bg1,\n          style: {\n            height: \"100px\",\n            width: \"auto\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 27\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 27\n          }\n        }, \"Se efetuou o pagamento, confirme-o!\")), /*#__PURE__*/React.createElement(Form, {\n          onSubmit: this.doSubmit,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(Row, {\n          form: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 27\n          }\n        }, /*#__PURE__*/React.createElement(Col, {\n          md: 12,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(FormGroup, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 31\n          }\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          htmlFor: \"email\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 33\n          }\n        }, \"Email\"), /*#__PURE__*/React.createElement(FormInput, {\n          id: \"email\",\n          type: \"text\",\n          placeholder: \"email\",\n          value: this.state.Email,\n          disabled: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 33\n          }\n        }))), /*#__PURE__*/React.createElement(Col, {\n          md: 12,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(FormGroup, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 31\n          }\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          htmlFor: \"payment\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 33\n          }\n        }, \"Confirmado?\"), /*#__PURE__*/React.createElement(FormInput, {\n          id: \"payment\",\n          type: \"text\",\n          placeholder: \"\",\n          value: this.state.payment === false ? \"Não\" : \"Sim\",\n          disabled: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 33\n          }\n        }))), /*#__PURE__*/React.createElement(Col, {\n          md: 12,\n          style: {\n            textAlign: \"center\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(Button, {\n          style: {\n            background: \"#34b4eb\",\n            color: \"#fff\",\n            width: \"200px\",\n            textAlign: \"center\"\n          },\n          disabled: this.state.payment === false ? false : true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 31\n          }\n        }, \"Confirmo que efetuei o pagamento da 1ª quota\")), /*#__PURE__*/React.createElement(Col, {\n          md: 12,\n          style: {\n            textAlign: \"center\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(Button, {\n          style: {\n            background: \"#34b4eb\",\n            color: \"#fff\",\n            width: \"200px\",\n            textAlign: \"center\"\n          },\n          onClick: this.LoginReturn,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 31\n          }\n        }, \"Regressar à Página de Login\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"text-center text-black opacity-8 mt-3\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 19\n          }\n        }, \"Copyright \\xA9\"), this.state.refresh)))));\n      }\n    }\n  }]);\n\n  return Payment_Page;\n}(CostumForm);\n\nexport default Payment_Page;","map":{"version":3,"sources":["C:/Users/User/Desktop/Ambiente de Trabalho/Universidade/Ano 3/Semestre 2/PI/Projeto/repos/pi-assoc-pais/develop/src/components/payment-page/PaymentPage.js"],"names":["React","Component","Fragment","Col","Row","Button","Form","FormGroup","FormFeedback","Input","FormInput","Link","Redirect","BlockUi","Loader","toast","Bounce","firestore","firebase_auth","firebase","CostumForm","bg1","languageCode","parentsParameters","errorSignOut","Payment_Page","props","doSubmit","e","preventDefault","Email","state","this_","ref","collection","doc","docPart","PAYED_FEE","update","then","console","log","refresh","pathname","payment","setState","catch","error","alert","json","JSON","stringify","email","blocking","errors","LoginReturn","bind","_isMounted","signOut","window","localStorage","removeItem","location","message","configure","transition","closeButton","autoClose","position","type","background","backgroundRepeat","backgroundSize","backgroundPosition","boxShadow","border","padding","height","width","textAlign","color"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport {\r\n  Col,\r\n  Row,\r\n  Button,\r\n  Form,\r\n  FormGroup,\r\n  FormFeedback,\r\n  Input,\r\n} from \"reactstrap\";\r\nimport { FormInput } from \"shards-react\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport BlockUi from \"react-block-ui\";\r\nimport { Loader } from \"react-loaders\";\r\nimport { toast, Bounce } from \"react-toastify\";\r\nimport { firestore, firebase_auth, firebase } from \"../../firebase-config\";\r\n\r\n//import * as UsersService from \"../../services/users/api_user\";\r\nimport CostumForm from \"../../common/Form/form\";\r\nimport bg1 from \"../../assets/mother.png\";\r\nimport { languageCode, parentsParameters } from \"../../utils/general_utils\";\r\nimport { errorSignOut } from \"../../utils/messages_strings\";\r\n\r\nclass Payment_Page extends CostumForm {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var json = JSON.stringify(this.props);\r\n\r\n    var email = this.props.email;\r\n    var payment = this.props.payment;\r\n\r\n    if (email == null) {\r\n      email = \"redirect\";\r\n    }\r\n\r\n    this.state = {\r\n      blocking: true,\r\n      Email: email,\r\n      payment: payment,\r\n      errors: {},\r\n      refresh: null,\r\n    };\r\n\r\n    this.LoginReturn = this.LoginReturn.bind(this);\r\n\r\n    //console.log(\"JSON: \" + json);\r\n    //console.log(\"state: \" + JSON.stringify(this.props.match.params));\r\n  }\r\n\r\n  /*********************************** LIFECYCLE ***********************************/\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n\r\n    // const user = UsersService.getCurrentUser();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  /*********************************** HANDLERS ***********************************/\r\n\r\n  LoginReturn() {\r\n    firebase_auth\r\n      .signOut()\r\n      .then(function () {\r\n        // Sign-out successful.\r\n        // clear local storage\r\n        window.localStorage.removeItem(\"userDoc\");\r\n        window.localStorage.removeItem(\"newParamsInputTypes\");\r\n        window.localStorage.removeItem(\"assocDoc\");\r\n        window.localStorage.removeItem(\"admin\");\r\n        window.localStorage.removeItem(\"email\");\r\n        window.location = \"/login\";\r\n      })\r\n      .catch(function (error) {\r\n        // An error happened.\r\n        var message = errorSignOut[languageCode];\r\n        toast.configure();\r\n        toast(message, {\r\n          transition: Bounce,\r\n          closeButton: true,\r\n          autoClose: 2000,\r\n          position: \"top-right\",\r\n          type: \"error\",\r\n        });\r\n      });\r\n  }\r\n  doSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const { Email } = this.state;\r\n    const this_ = this;\r\n\r\n    //Escrever na base de dados no doc parents/<email> que firstPayment=true;\r\n    var ref = firestore.collection(\"parents\").doc(Email);\r\n\r\n    let docPart = {};\r\n    docPart[parentsParameters.PAYED_FEE[languageCode]] = true;\r\n\r\n    return ref\r\n      .update(docPart)\r\n      .then(function () {\r\n        console.log(\"Document successfully updated!\");\r\n        var refresh = (\r\n          <Redirect\r\n            to={{\r\n              pathname: \"/payment\",\r\n              state: { Email: Email, payment: true },\r\n            }}\r\n          />\r\n        );\r\n        this_.setState({ payment: true, refresh: refresh });\r\n      })\r\n      .catch(function (error) {\r\n        // The document probably doesn't exist.\r\n        //console.error(\"Error updating document: \", error);\r\n        alert(\"Erro no envio, por favor, volte a tentar\");\r\n      });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.Email === \"redirect\") {\r\n      return <Redirect to=\"/login\" />;\r\n    } else {\r\n      return (\r\n        <Fragment>\r\n          <BlockUi\r\n            tag=\"div\"\r\n            blocking={this.state.blocking}\r\n            loader={<Loader active type=\"line-scale-pulse-out\" />}\r\n          >\r\n            <div className=\"h-100 bg-animation\">\r\n              <div\r\n                className=\"d-flex h-100 justify-content-center align-items-center\"\r\n                style={{\r\n                  background: \"url(\" + bg1 + \")\",\r\n                  backgroundRepeat: \"no-repeat\",\r\n                  backgroundSize: \"cover\",\r\n                  backgroundPosition: \"center center\",\r\n                }}\r\n              >\r\n                <Col md=\"8\" className=\"mx-auto app-login-box\">\r\n                  <div\r\n                    className=\"modal-dialog w-100 mx-auto\"\r\n                    style={{\r\n                      boxShadow: \"0px 1px 10px 0px rgba(52, 58, 64, 0.3)\",\r\n                    }}\r\n                  >\r\n                    <div className=\"modal-content\" style={{ border: \"none\" }}>\r\n                      <div className=\"modal-body\" style={{ padding: \"2.5rem\" }}>\r\n                        <div className=\"h6 modal-title text-center mb-4\">\r\n                          <img\r\n                            className=\"mb-4\"\r\n                            src={bg1}\r\n                            style={{ height: \"100px\", width: \"auto\" }}\r\n                          />\r\n                          <p>Se efetuou o pagamento, confirme-o!</p>\r\n                        </div>\r\n                        <Form onSubmit={this.doSubmit}>\r\n                          <Row form>\r\n                            <Col md={12}>\r\n                              <FormGroup>\r\n                                <label htmlFor=\"email\">Email</label>\r\n                                <FormInput\r\n                                  id=\"email\"\r\n                                  type=\"text\"\r\n                                  placeholder=\"email\"\r\n                                  value={this.state.Email}\r\n                                  disabled={true}\r\n                                />\r\n                              </FormGroup>\r\n                            </Col>\r\n\r\n                            <Col md={12}>\r\n                              <FormGroup>\r\n                                <label htmlFor=\"payment\">Confirmado?</label>\r\n                                <FormInput\r\n                                  id=\"payment\"\r\n                                  type=\"text\"\r\n                                  placeholder=\"\"\r\n                                  value={\r\n                                    this.state.payment === false ? \"Não\" : \"Sim\"\r\n                                  }\r\n                                  disabled={true}\r\n                                />\r\n                              </FormGroup>\r\n                            </Col>\r\n\r\n                            <Col md={12} style={{ textAlign: \"center\" }}>\r\n                              <Button\r\n                                style={{\r\n                                  background: \"#34b4eb\",\r\n                                  color: \"#fff\",\r\n                                  width: \"200px\",\r\n                                  textAlign: \"center\",\r\n                                }}\r\n                                disabled={\r\n                                  this.state.payment === false ? false : true\r\n                                }\r\n                              >\r\n                                {\"Confirmo que efetuei o pagamento da 1ª quota\"}\r\n                              </Button>\r\n                            </Col>\r\n                            <Col md={12} style={{ textAlign: \"center\" }}>\r\n                              <Button\r\n                                style={{\r\n                                  background: \"#34b4eb\",\r\n                                  color: \"#fff\",\r\n                                  width: \"200px\",\r\n                                  textAlign: \"center\",\r\n                                }}\r\n                                onClick={this.LoginReturn}\r\n                              >\r\n                                {\"Regressar à Página de Login\"}\r\n                              </Button>\r\n                            </Col>\r\n                          </Row>\r\n                        </Form>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"text-center text-black opacity-8 mt-3\">\r\n                    Copyright &copy;\r\n                  </div>\r\n                  {this.state.refresh}\r\n                </Col>\r\n              </div>\r\n            </div>\r\n          </BlockUi>\r\n        </Fragment>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default Payment_Page;\r\n"]},"metadata":{},"sourceType":"module"}